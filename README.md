# Jamison Stamps & Books (2025 site)

Static business website for Jamison Enterprises Stamps & Books.

This repo is mostly “plain HTML + CSS + JavaScript” (no build step). Pages share a common header/menu/footer/sidebar via small JavaScript include files that write HTML into the page. The stamps catalog page (`stamps/USA.htm`) is a client-side app that renders a large stamp inventory list from a JavaScript data array and integrates with PayPal’s cart.

## Tech stack

- **HTML/CSS**: Hand-authored static pages + a shared template stylesheet.
- **JavaScript**:
	- Site-wide template scripts (header/menu/footer/sidebar/calendar/contact).
	- A small jQuery utility file for the mobile menu toggle and the “scroll to top” arrow.
	- A standalone vanilla-JS catalog renderer for the stamp inventory.
- **Third-party**:
	- **jQuery 1.11.3**: `JQuery/jquery-1.11.3.min.js` (used by `js/javascripts.js`).
	- **PayPal Cart (NCP)**: loaded from `https://www.paypalobjects.com/ncp/cart/cart.js` on the stamps page.
	- `JQuery/jquery.simplePagination.js` exists in the repo but is not currently used by the stamps page (pagination is implemented in `stamps/js/stamps_v3.js`).

## Project layout (high level)

Key files/folders:

- `index.html`: Homepage.
- `about.htm`, `contact.htm`, `resources.htm`, `testimonials.htm`, `site_map.htm`, `thanks*.htm`: Content pages.
- `css/style.css`, `css/media-queries.css`: Global styling + responsive overrides.
- `js/`:
	- `header.js`: Injects the site header + logo.
	- `menu.js`: Injects the navigation links + mobile “hamburger” icon.
	- `footer.js`: Injects the footer and the “scroll to top” anchor.
	- `sidebar.js`: Injects the site-wide sidebar topic box.
	- `calendar.js`: Injects a small month calendar widget.
	- `contact.js`: Injects the contact/address block used on some pages.
	- `javascripts.js`: jQuery behaviors (scroll-to-top + mobile menu toggling/click-away).
- `picts/`: Images.
- `stamps/`: Stamps catalog mini-site (own `css/` and `js/`).
	- `stamps/USA.htm`: Catalog page (filters/sort/pagination + PayPal cart).
	- `stamps/css/stamps.css`: Catalog-specific styling.
	- `stamps/js/stamps_v3.js`: Inventory data + filter/sort/pagination + PayPal Add-to-Cart integration.

## How pages are composed (template-style “includes”)

Most pages follow the same pattern as `index.html`:

1. Load the global stylesheet(s).
2. Load jQuery and `js/javascripts.js` (site behaviors).
3. Inside `<body>`, insert shared page sections by loading scripts that call `document.write()`.

For example, the homepage inserts these shared pieces:

- Header: `js/header.js`
- Top navigation: `js/menu.js`
- Sidebar content box: `js/sidebar.js`
- Calendar widget: `js/calendar.js`
- Footer: `js/footer.js` (and reuses `js/menu.js` in the footer)

### Why `document.write()`?

These scripts are a classic template approach used to avoid copying the same header/menu/footer HTML into every page. When the browser parses the page, it executes the script tag and writes markup directly into the document stream at that location.

Important implications:

- These scripts must run during initial HTML parsing. If they’re deferred or executed after the document finishes loading, `document.write()` can overwrite the document.
- Relative paths matter. The stamps mini-site has its own copies of `header.js` and `menu.js` under `stamps/js/` that use `../` paths for assets.

## Site-wide JavaScript behaviors

### Mobile menu toggle + click-away close

Implemented in `js/javascripts.js`:

- `toggleMenu(divId)` toggles the mobile menu container.
- If `clickaway` is enabled, it closes the mobile menu when clicking outside the menu on small viewports.

The menu HTML (generated by `js/menu.js`) calls `toggleMenu('menusub')` when the hamburger icon is clicked.

### Scroll-to-top arrow

Implemented in `js/javascripts.js` + `js/footer.js`:

- `footer.js` writes the `<a href="#" class="scrollToTop"></a>` anchor.
- `javascripts.js` attaches scroll listeners and animates to top when clicked.

## The stamps catalog (inventory + UI + PayPal)

The catalog is a client-side app in:

- Page: `stamps/USA.htm`
- Logic & data: `stamps/js/stamps_v3.js`
- Styles: `stamps/css/stamps.css`

### Page structure expected by `stamps_v3.js`

`stamps/js/stamps_v3.js` assumes the page contains these elements:

- Search input: `<input id="searchBox">` (searches by Scott # substring)
- Filters:
	- `<select id="conditionFilter">`
	- `<select id="hingedFilter">`
	- `<select id="gumFilter">`
	- `<select id="gradeFilter">` (optional; present in `USA.htm`)
- Sort selector: `<select id="sortOptions">`
- A render target: `<article class="content"></article>`

On `DOMContentLoaded` the script:

1. Populates filter dropdowns based on unique values in the dataset.
2. Wires event listeners for filters/search/sort.
3. Renders the first page of results.

### Inventory data model

In `stamps/js/stamps_v3.js`, the `stamps` array is the “database”. Each entry is a plain object:

```js
{
	scott: "C115",
	condition: "Used",
	hinged: "Hinged",
	gum: "No Gum",
	grade: "Very Good/Fine",
	price: 0.07,
	location: "SL01-0001-05-01",
	paypalId: "RW9FSSALGFE5L"
}
```

Field notes:

- `scott` is treated as a string and supports prefixes/suffixes (e.g., `C115`, `219D`).
- `price` is numeric and is used for sorting.
- `paypalId` is the PayPal “Add to Cart” button id consumed by PayPal’s cart SDK.

### Filtering and sorting

The core pipeline is:

1. `applyFiltersAndSort(stamps)`:
	 - Filters by Scott query + condition/hinged/gum/grade selections.
	 - Sorts by Scott or price.
2. `renderPage(filtered)`:
	 - Slices the array to the current page.
	 - Renders each stamp as a `<section class="stamp">`.
	 - Renders pagination controls above and below the list.

Scott sorting is “aware” of letter prefixes and suffixes:

- It splits `scott` into `(prefix letters, number, suffix letters)`.
- It sorts by prefix, then numeric part, then suffix.

### Pagination

Pagination is implemented directly in `stamps/js/stamps_v3.js`:

- `PAGE_SIZE` controls items per page (currently `25`).
- Two pagers are created dynamically:
	- `pagerTop` (inserted before `<article class="content">`)
	- `pagerBottom` (inserted after)
- Each pager includes:
	- First/Prev/Next/Last buttons
	- A “Jump to” numeric input + Go button

### PayPal cart integration

The PayPal cart SDK is loaded on the stamps page:

```html
<script src="https://www.paypalobjects.com/ncp/cart/cart.js" data-merchant-id="BSB86CSLZFYL2"></script>
```

Cart button in the sidebar:

```html
<paypal-cart-button data-id="pp-view-cart"></paypal-cart-button>
<script>
	cartPaypal.Cart({ id: "pp-view-cart" })
</script>
```

For each stamp row, the catalog script creates an add-to-cart web component:

- Element: `<paypal-add-to-cart-button data-id="<paypalId>"></paypal-add-to-cart-button>`

Then it initializes PayPal’s handler:

- `cartPaypal.AddToCart({ id })`

To keep the page fast, add-to-cart initialization is **lazy**:

- `IntersectionObserver` watches each stamp section.
- When a section scrolls into view, it initializes PayPal for that button.
- There’s also a readiness guard (`whenPaypalReady()`) that waits for the PayPal SDK to expose `window.cartPaypal.AddToCart` before calling it.

## Running locally

This project is a static site. You can host it with any local web server.

### Using the existing VS Code task

The workspace includes a task that opens Chrome to:

- `http://2025jamisonstamps.localhost/`

Run the VS Code task:

- **Open in Browser**

Note: this assumes you already have a local web server + host mapping configured for `2025jamisonstamps.localhost`.

### Why you should use HTTP (not file://)

Some third-party scripts (notably PayPal’s cart SDK) may behave differently or be blocked when pages are opened directly from disk via `file://`. Hosting via a local server is the safest way to match production behavior.

## Common edits / maintenance

- **Change logo text/behavior**: edit variables in `js/header.js`.
- **Change navigation links**:
	- Root pages: `js/menu.js`
	- Stamps pages: `stamps/js/menu.js`
- **Update footer year/text**: `js/footer.js`.
- **Update contact info**: `js/contact.js`.
- **Update stamps inventory**:
	- Add/edit items in the `stamps` array in `stamps/js/stamps_v3.js`.
	- Ensure each item has the correct `paypalId`.
	- Adjust `PAGE_SIZE` if needed.

## Notes / gotchas

- The main site uses jQuery for a couple of behaviors, but the stamps catalog is written in vanilla JS.
- Some template scripts contain embedded copyright notices (from the original template vendor). Preserve those notices if you continue using those scripts.
